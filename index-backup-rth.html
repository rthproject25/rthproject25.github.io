<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ride To Hell</title>
<style>
/* ===========================
   RESET + BASE
   =========================== */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:"Inter",Arial,Helvetica,sans-serif;
  -webkit-font-smoothing:antialiased;
  color:#fff;
  line-height:1.4;
  min-height:100vh;
  position:relative;
  -webkit-text-size-adjust:100%;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
  background:#000;
}

/* ===========================
   BACKGROUND LAYER (non-invasive)
   =========================== */
#rth-bg-layer{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden}
#rth-bg-layer .bg{position:absolute;inset:0;background-position:center;background-size:cover;background-repeat:no-repeat;opacity:0;transition:opacity 600ms ease;will-change:opacity,transform}
#rth-bg-layer .bg-off{background-image:url('bg-darkoff.png');opacity:1;animation:rth-bg-off 48s linear infinite;filter:contrast(0.92) brightness(0.9)}
#rth-bg-layer .bg-on{background-image:url('bg-blood.png');opacity:0;animation:rth-bg-on 62s linear infinite;filter:saturate(0.95) contrast(0.95) brightness(0.96)}
body.blood #rth-bg-layer .bg-off{opacity:0}
body.blood #rth-bg-layer .bg-on{opacity:1}
@keyframes rth-bg-off{0%{transform:translate3d(-2%,-1%,0) scale(1.02)}25%{transform:translate3d(1%,0.5%,0) scale(1.03)}50%{transform:translate3d(2%,1%,0) scale(1.025)}75%{transform:translate3d(-1%,0%,0) scale(1.015)}100%{transform:translate3d(-2%,-1%,0) scale(1.02)}}
@keyframes rth-bg-on{0%{transform:translate3d(1.5%,1%,0) scale(1.03)}20%{transform:translate3d(-1%,0.5%,0) scale(1.035)}45%{transform:translate3d(0.5%,-0.5%,0) scale(1.025)}70%{transform:translate3d(1%,0.2%,0) scale(1.04)}100%{transform:translate3d(1.5%,1%,0) scale(1.03)}}

/* VIGNETTE */
#rth-vignette{position:fixed;inset:0;z-index:1;pointer-events:none;background:radial-gradient(ellipse at center, rgba(0,0,0,0) 35%, rgba(0,0,0,0.55) 100%);transition:background .6s ease}
body.blood #rth-vignette{background:radial-gradient(ellipse at center, rgba(0,0,0,0.12) 25%, rgba(0,0,0,0.68) 100%)}

/* ===========================
   ANIM OVERLAY (clouds/grain/smoke/lightning/embers/drips/particles)
   z-index ordering: bg-layer(0) -> vignette(1) -> anim-overlay(2) -> content(3)
   =========================== */
#rth-anim-overlay{position:fixed;inset:0;z-index:2;pointer-events:none;overflow:hidden;font-family:inherit}

/* CLOUDS */
.rth-clouds{position:absolute;inset:-10% -10% -10% -10%;opacity:.28;mix-blend-mode:multiply;filter:blur(12px) contrast(.95);
  background-image:
    radial-gradient(ellipse at 20% 30%, rgba(255,255,255,0.025) 0%, rgba(255,255,255,0) 40%),
    radial-gradient(ellipse at 80% 70%, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0) 50%),
    linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,0.08));
  animation:rth-cloud 26s ease-in-out infinite}
@keyframes rth-cloud{0%{transform:translate3d(-4%,-2%,0) scale(1.02)}50%{transform:translate3d(4%,2%,0) scale(1.015)}100%{transform:translate3d(-4%,-2%,0) scale(1.02)}}

/* GRAIN */
.rth-grain{position:absolute;inset:0;opacity:.08;mix-blend-mode:overlay;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="180" height="180"><filter id="g"><feTurbulence baseFrequency="0.9" numOctaves="2"/><feColorMatrix type="saturate" values="0"/></filter><rect width="100%" height="100%" filter="url(%23g)" fill="white"/></svg>');transform:scale(1.02);animation:rth-grain 14s linear infinite}
@keyframes rth-grain{0%{transform:scale(1.02) translate(0,0)}50%{transform:scale(1.025) translate(-1%,0.5%)}100%{transform:scale(1.02) translate(0,0)}}

/* LIGHTNING */
.rth-lightning{position:absolute;inset:0;mix-blend-mode:screen;transition:background 240ms ease}

/* SMOKE */
.rth-smoke{position:absolute;left:-10%;width:120%;top:110%;height:80%;pointer-events:none;overflow:visible}
.rth-smoke .s{position:absolute;left:0;width:100%;height:120%;background:radial-gradient(ellipse at 50% 40%, rgba(255,255,255,0.22) 0%, rgba(255,255,255,0) 40%);mix-blend-mode:screen;filter:blur(28px) contrast(.95);opacity:.22;animation:rth-smoke-move 22000ms linear infinite}
.rth-smoke .s.s2{left:-5%;opacity:.18;filter:blur(36px) contrast(.92);animation-duration:25960ms;transform:scale(1.12)}
@keyframes rth-smoke-move{0%{transform:translateY(0) scale(1.05);opacity:0}10%{opacity:.14}50%{transform:translateY(-60%) scale(1.08);opacity:.28}90%{opacity:.08}100%{transform:translateY(-120%) scale(1.12);opacity:0}}

/* HELLFIRE (embers + flame) */
.rth-hellfire{position:absolute;inset:0;pointer-events:none;opacity:0;transition:opacity .6s ease;mix-blend-mode:screen}
.rth-hellfire .embers{position:absolute;inset:0;background-image:
  radial-gradient(circle at 20% 80%, rgba(255,120,40,0.08), rgba(255,120,40,0)),
  radial-gradient(circle at 80% 90%, rgba(255,90,30,0.06), rgba(255,90,30,0));
  filter:blur(24px);animation:emberFlick 6s ease-in-out infinite}
.rth-hellfire .flame{position:absolute;inset:0;background:linear-gradient(180deg, rgba(255,90,30,0.06), rgba(255,30,10,0.02));filter:blur(8px) saturate(1.1);opacity:0;transition:opacity .6s ease}
@keyframes emberFlick{0%{transform:translateY(0)}50%{transform:translateY(-2%)}100%{transform:translateY(0)}}
body.hellfire .rth-hellfire{opacity:1}
body.hellfire .rth-hellfire .flame{opacity:1}

/* BLOOD DRIPS - CSS animated streaks (appear only when blood active) */
.rth-drips{position:absolute;inset:0;pointer-events:none;opacity:0;transition:opacity .6s ease}
.rth-drips .drip{position:absolute;width:2px;background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0));opacity:.06;filter:blur(.6px);border-radius:2px;transform:translateY(-20%)}
.rth-drips .drip.d1{left:18%;top:10%;height:120px;animation:drip1 4200ms linear infinite}
.rth-drips .drip.d2{left:54%;top:8%;height:90px;animation:drip2 5200ms linear infinite}
.rth-drips .drip.d3{left:78%;top:18%;height:140px;animation:drip3 4800ms linear infinite}
@keyframes drip1{0%{transform:translateY(-40%)}80%{transform:translateY(0)}100%{transform:translateY(0);opacity:0}}
@keyframes drip2{0%{transform:translateY(-60%)}85%{transform:translateY(0)}100%{transform:translateY(0);opacity:0}}
@keyframes drip3{0%{transform:translateY(-50%)}82%{transform:translateY(0)}100%{transform:translateY(0);opacity:0}}
body.blood .rth-drips{opacity:1}

/* ===========================
   PARTICLES CANVAS (micro blood particles)
   - placed in overlay, but drawn with canvas for perf
   =========================== */
#rth-particles{ position:absolute; inset:0; z-index:2; pointer-events:none; }

/* ===========================
   CONTENT (kept above overlays)
   =========================== */
.wrap{width:100%;max-width:820px;margin:0 auto;padding:22px 18px 80px;position:relative;z-index:4}

.logo{width:96px;height:96px;margin:4px auto 10px;border-radius:20px;background-image:url('logo.png');background-size:cover;background-position:center;box-shadow:0 14px 40px rgba(0,0,0,0.7);transform:translateZ(0);animation:rth-logo-breath 2200ms ease-in-out infinite}
@keyframes rth-logo-breath{0%{transform:scale(.98) rotate(-0.8deg)}40%{transform:scale(1.02) rotate(.6deg)}70%{transform:scale(1.01) rotate(-0.3deg)}100%{transform:scale(.98) rotate(-0.8deg)}}
.logo.glitch::after{content:"";position:absolute;inset:0;pointer-events:none;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0));mix-blend-mode:overlay;opacity:0;transition:opacity .22s ease}
.logo.glitch::after{animation:rth-glitch 420ms steps(4, end) 1;opacity:1}
@keyframes rth-glitch{0%{clip-path:inset(0 0 0 0)}25%{clip-path:inset(6% 0 60% 0)}50%{clip-path:inset(30% 0 20% 0)}75%{clip-path:inset(0 0 40% 0)}100%{clip-path:inset(0 0 0 0)}}

h1{font-weight:800;text-align:center;letter-spacing:10px;margin-top:8px;margin-bottom:8px;font-size:30px}
.subtitle{max-width:760px;margin:8px auto 8px;font-size:14.5px;opacity:0.95;text-align:center}
.bold-line{font-weight:800;margin-top:10px;margin-bottom:8px;text-align:center;font-size:15px}
.note{text-align:center;margin-bottom:10px;opacity:0.7;font-size:13px}
.blood-row{display:flex;justify-content:center;gap:18px;margin:8px 0 12px;opacity:0.45;letter-spacing:9px;font-size:14px}

/* SWITCH */
.switch-wrap{display:flex;justify-content:center;margin-bottom:20px}
.switch{width:128px;height:56px;border-radius:36px;background:linear-gradient(180deg,#0f0f0f,#070707 60%);position:relative;cursor:pointer;box-shadow:inset 0 6px 18px rgba(255,255,255,0.02),0 10px 26px rgba(0,0,0,0.6);transition:background .28s ease, box-shadow .28s ease;display:inline-block}
.knob{width:50px;height:50px;border-radius:50%;background:#fff;position:absolute;top:3px;left:8px;transform: translateX(0);transition: transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .18s;box-shadow:0 12px 30px rgba(0,0,0,0.6)}
.switch[data-state="on"] .knob{ transform: translateX(70px) }
body.blood .switch{ background:linear-gradient(180deg,#6f2f2f,#401616 60%);box-shadow:inset 0 6px 20px rgba(120,20,20,0.06), 0 12px 36px rgba(120,20,20,0.2) }

/* LIST/CARDS */
.list{margin-top:6px;display:flex;flex-direction:column;gap:16px;padding-bottom:18px}
.card{display:flex;align-items:center;gap:16px;padding:18px;border-radius:18px;background:linear-gradient(160deg,#141414 0%, #0d0d0d 60%, #060606 100%);box-shadow:inset 0 1px 0 rgba(255,255,255,0.02),0 20px 40px rgba(0,0,0,0.7);border:1px solid rgba(255,255,255,0.02)}
.icon{min-width:64px;height:64px;border-radius:14px;background:linear-gradient(145deg,#1b1b1b,#080808);display:flex;justify-content:center;align-items:center;font-weight:900;font-size:18px;box-shadow: inset 0 2px 6px rgba(255,255,255,0.02)}
.text{flex:1;min-width:0}
.top-title{font-size:18px;font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.sub{font-size:13px;opacity:0.75;margin-top:6px}
.cta{padding:10px 16px;border-radius:14px;background:linear-gradient(145deg,#191919,#292929 60%);color:#fff;text-decoration:none;font-weight:800;font-size:15px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 10px 26px rgba(0,0,0,0.6);white-space:nowrap;transition:.12s ease}
body.blood .cta{background:linear-gradient(145deg,#9f5b57,#7b2e2e 60%);border:1px solid rgba(255,210,205,0.08);box-shadow:0 10px 30px rgba(120,20,20,0.28);color:#fff}

footer{margin-top:26px;text-align:center;opacity:0.6;padding-bottom:30px;font-size:13px}

/* LOADER (topmost) */
#rth-loader{position:fixed;inset:0;z-index:9999999;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.93);transition:opacity .6s cubic-bezier(.2,.9,.2,1)}
#rth-loader.hidden{opacity:0;pointer-events:none}
#rth-loader .rlogo{width:110px;height:110px;border-radius:18px;background:url('logo.png') center/cover no-repeat;animation:rlogo 2.2s ease-in-out infinite}
@keyframes rlogo{0%{transform:scale(.98) rotate(-1deg)}40%{transform:scale(1.03) rotate(.6deg)}70%{transform:scale(1.01) rotate(-.3deg)}100%{transform:scale(.98) rotate(-1deg)}}

/* responsive tweaks */
@media (max-width:420px){
  .wrap{padding:20px 14px 80px}
  .logo{width:92px;height:92px;border-radius:18px}
  h1{font-size:28px;letter-spacing:8px;margin-bottom:6px}
  .switch{width:120px;height:56px}
  .knob{width:44px;height:44px;top:6px;left:8px}
  .switch[data-state="on"] .knob{ transform: translateX(66px) }
  .icon{min-width:56px;height:56px}
  .card{padding:14px;border-radius:16px}
  .top-title{font-size:17px}
  .cta{padding:9px 14px;font-size:14px}
}
</style>
</head>
<body>

  <!-- BACKGROUND LAYER -->
  <div id="rth-bg-layer" aria-hidden="true">
    <div class="bg bg-off" aria-hidden="true"></div>
    <div class="bg bg-on" aria-hidden="true"></div>
  </div>

  <!-- VIGNETTE -->
  <div id="rth-vignette" aria-hidden="true"></div>

  <!-- ANIM OVERLAY -->
  <div id="rth-anim-overlay" aria-hidden="true">
    <div class="rth-clouds" aria-hidden="true"></div>
    <div class="rth-grain" aria-hidden="true"></div>
    <div class="rth-lightning" aria-hidden="true"></div>

    <!-- CSS drips -->
    <div class="rth-drips" aria-hidden="true">
      <div class="drip d1"></div>
      <div class="drip d2"></div>
      <div class="drip d3"></div>
    </div>

    <!-- Hellfire -->
    <div class="rth-hellfire" aria-hidden="true">
      <div class="embers" aria-hidden="true"></div>
      <div class="flame" aria-hidden="true"></div>
    </div>

    <!-- Smoke -->
    <div class="rth-smoke" aria-hidden="true">
      <div class="s s1" aria-hidden="true"></div>
      <div class="s s2" aria-hidden="true"></div>
    </div>

    <!-- canvas for particles -->
    <canvas id="rth-particles" aria-hidden="true"></canvas>
  </div>

  <!-- CONTENT (unchanged layout) -->
  <div class="wrap" role="main" aria-label="Ride To Hell">
    <div class="logo" aria-hidden="true"></div>
    <h1>RIDE TO HELL</h1>
    <div class="subtitle">Teritori gelap ini rumah gue. Tempat gue jatuh, bangkit, dan ngegas sendirian.</div>
    <div class="bold-line">RTH bukan sekadar nama — ini cara gue bertahan.</div>
    <div class="note">Simple contact · No noise</div>

    <div class="blood-row" aria-hidden="true"><div>B</div><div>L</div><div>O</div><div>O</div><div>D</div></div>

    <div class="switch-wrap">
      <div id="switch" class="switch" role="switch" aria-checked="false" tabindex="0" data-state="off">
        <div class="knob" aria-hidden="true"></div>
      </div>
    </div>

    <div class="list" aria-label="Kontak">
      <div class="card">
        <div class="icon">IG</div>
        <div class="text">
          <div class="top-title">@ridetohhell.official</div>
          <div class="sub">Instagram Resmi</div>
        </div>
        <a class="cta" href="https://instagram.com/ridetohhell.official" target="_blank" rel="noopener">Masuk</a>
      </div>

      <div class="card">
        <div class="icon">WA</div>
        <div class="text">
          <div class="top-title">Chat via WhatsApp — +62 858-8211-0680</div>
          <div class="sub">Fast contact</div>
        </div>
        <a class="cta" href="https://wa.me/6285882110680" target="_blank" rel="noopener">Terhubung</a>
      </div>

      <div class="card">
        <div class="icon">YT</div>
        <div class="text">
          <div class="top-title">YouTube Channel</div>
          <div class="sub">@RTHProject25</div>
        </div>
        <a class="cta" href="https://youtube.com/@RTHProject25" target="_blank" rel="noopener">Tonton</a>
      </div>

      <div class="card">
        <div class="icon">f</div>
        <div class="text">
          <div class="top-title">Halaman Facebook</div>
          <div class="sub">Ride To Hell</div>
        </div>
        <a class="cta" href="https://facebook.com" target="_blank" rel="noopener">Buka</a>
      </div>
    </div>

    <footer>© 2025 Ride To Hell</footer>
  </div>

  <!-- LOADER -->
  <div id="rth-loader" role="status" aria-live="polite" aria-label="Loading Ride To Hell">
    <div class="rlogo" aria-hidden="true"></div>
  </div>

<script>
/* =====================================================
   Utility & Controls (exposed)
   ===================================================== */
window.__rth_controls = window.__rth_controls || {};
(function(ctrl){
  ctrl.quality = 'high'; // 'low' reduces particles
  ctrl.overlayEnabled = true;
  ctrl.soundEnabled = true;
  ctrl.setQuality = function(q){
    ctrl.quality = q;
    if(q==='low'){ window.__rth_particles && window.__rth_particles.setCount(30); }
    else { window.__rth_particles && window.__rth_particles.setCount(90); }
  };
  ctrl.disableOverlay = function(){ document.getElementById('rth-anim-overlay').style.display='none'; ctrl.overlayEnabled=false; };
  ctrl.enableOverlay = function(){ document.getElementById('rth-anim-overlay').style.display='block'; ctrl.overlayEnabled=true; };
  ctrl.toggleBlood = function(v){ const s = document.getElementById('switch'); const on = (v===undefined)? (document.body.classList.toggle('blood')) : !!v; if(v!==undefined){ if(v) document.body.classList.add('blood'); else document.body.classList.remove('blood'); s.dataset.state = v ? 'on' : 'off'; } return document.body.classList.contains('blood'); };
  ctrl.toggleHellfire = function(v){ if(v===undefined) document.body.classList.toggle('hellfire'); else if(v) document.body.classList.add('hellfire'); else document.body.classList.remove('hellfire'); };
  ctrl.sound = {
    enable:function(){ ctrl.soundEnabled=true; },
    disable:function(){ ctrl.soundEnabled=false; },
    playOn:function(){ try{ window.__rth_sound && window.__rth_sound.playOn(); }catch(e){} },
    playOff:function(){ try{ window.__rth_sound && window.__rth_sound.playOff(); }catch(e){} }
  };
})(window.__rth_controls);

/* =====================================================
   SOUND: WebAudio synth for toggle feedback
   ===================================================== */
(function(){
  const audio = { ctx:null, enabled:true };
  audio.ensure = function(){
    if(audio.ctx) return audio.ctx;
    try{
      const C = window.AudioContext || window.webkitAudioContext;
      audio.ctx = new C();
      return audio.ctx;
    }catch(e){ audio.ctx = null; return null; }
  };
  function blip(on){
    if(!window.__rth_controls.soundEnabled) return;
    const ctx = audio.ensure(); if(!ctx) return;
    const t = ctx.currentTime;
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.type = 'sine';
    if(on){
      o.frequency.value = 420;
      g.gain.value = 0.0045;
      o.connect(g); g.connect(ctx.destination);
      o.start(t);
      o.frequency.exponentialRampToValueAtTime(880, t + 0.08);
      g.gain.exponentialRampToValueAtTime(0.0001, t + 0.18);
      o.stop(t + 0.18);
    } else {
      o.frequency.value = 280;
      g.gain.value = 0.0032;
      o.connect(g); g.connect(ctx.destination);
      o.start(t);
      o.frequency.exponentialRampToValueAtTime(200, t + 0.06);
      g.gain.exponentialRampToValueAtTime(0.0001, t + 0.12);
      o.stop(t + 0.12);
    }
  }
  window.__rth_sound = { playOn: ()=> blip(true), playOff: ()=> blip(false) };
  document.addEventListener('pointerdown', function tryResume(){
    try{ audio.ensure() && audio.ctx && audio.ctx.state === 'suspended' && audio.ctx.resume(); }catch(e){}
    document.removeEventListener('pointerdown', tryResume);
  }, {once:true});
})();

/* =====================================================
   PARTICLES (Canvas) - micro blood/ash particles
   - adaptive count for perf
   ===================================================== */
(function(){
  const canvas = document.getElementById('rth-particles');
  if(!canvas) return;
  const ctx = canvas.getContext('2d');
  let width = 0, height = 0, DPR = Math.max(1, window.devicePixelRatio || 1);
  function resize(){
    width = canvas.clientWidth || window.innerWidth;
    height = canvas.clientHeight || window.innerHeight;
    canvas.width = Math.floor(width * DPR);
    canvas.height = Math.floor(height * DPR);
    ctx.setTransform(DPR,0,0,DPR,0,0);
  }
  resize();
  window.addEventListener('resize', resize, {passive:true});

  // Particle system
  const particleSys = {
    particles: [],
    max: 90,
    enabled: true,
    spawnRate: 2, // per frame
    colors: {
      blood: ['rgba(150,30,30,0.9)','rgba(180,50,50,0.7)','rgba(220,80,80,0.5)'],
      ash: ['rgba(200,200,200,0.12)','rgba(180,180,180,0.08)']
    },
    setCount(n){
      this.max = Math.max(10, n);
    },
    reset(){ this.particles = []; },
    spawn(type){
      if(this.particles.length >= this.max) return;
      const x = Math.random() * width;
      const size = (type==='blood') ? (2 + Math.random()*4) : (1 + Math.random()*3);
      const vy = (type==='blood') ? (0.3 + Math.random()*1.2) : (0.1 + Math.random()*0.6);
      const life = 2200 + Math.random()*2800;
      const color = (type==='blood') ? this.colors.blood[Math.floor(Math.random()*this.colors.blood.length)] : this.colors.ash[Math.floor(Math.random()*this.colors.ash.length)];
      this.particles.push({x:x, y:-10, vx:(Math.random()-0.5)*0.2, vy:vy, size:size, life:life, t:0, color:color, type:type});
    },
    update(dt){
      for(let i=this.particles.length-1;i>=0;i--){
        const p = this.particles[i];
        p.t += dt;
        p.x += p.vx * dt;
        p.y += p.vy * dt;
        if(p.t > p.life || p.y > height + 40) this.particles.splice(i,1);
      }
    },
    draw(ctx){
      ctx.clearRect(0,0,width,height);
      for(const p of this.particles){
        ctx.save();
        if(p.type==='blood'){
          // soft circle with small trail
          const alpha = 1 - (p.t / p.life);
          ctx.fillStyle = p.color.replace(/[\d\.]+\)$/,'1)');
          ctx.beginPath();
          ctx.globalAlpha = Math.max(0.08, alpha*0.95);
          ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
          ctx.fill();
          // tiny streak
          ctx.fillStyle = 'rgba(0,0,0,0.12)';
          ctx.fillRect(p.x - 0.5, p.y, 1, Math.min(12, p.size*6));
        } else {
          const alpha = 1 - (p.t / p.life);
          ctx.fillStyle = p.color;
          ctx.globalAlpha = Math.max(0.02, alpha*0.6);
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
          ctx.fill();
        }
        ctx.restore();
      }
    }
  };

  // API to control particles externally
  window.__rth_particles = {
    setCount: (n)=> particleSys.setCount(n),
    enable: ()=> particleSys.enabled = true,
    disable: ()=> { particleSys.enabled = false; particleSys.reset(); },
    reset: ()=> particleSys.reset()
  };

  // adaptive spawn based on mode
  let last = performance.now();
  function frame(now){
    const dtMs = now - last;
    last = now;
    const dt = dtMs;
    // spawn logic: when blood mode -> spawn blood particles; when hellfire -> spawn embers; otherwise slow ash
    const isBlood = document.body.classList.contains('blood');
    const isHell = document.body.classList.contains('hellfire');
    if(particleSys.enabled){
      // spawn count dependent on quality
      const maxSpawn = (window.__rth_controls.quality === 'low') ? 1 : 3;
      if(isBlood){
        for(let i=0;i<maxSpawn;i++) particleSys.spawn('blood');
      } else if(isHell){
        for(let i=0;i<Math.max(1,Math.round(maxSpawn/2));i++) particleSys.spawn('ash');
      } else {
        if(Math.random() < 0.25) particleSys.spawn('ash');
      }
    }
    particleSys.update(dt);
    particleSys.draw(ctx);
    requestAnimationFrame(frame);
  }
  requestAnimationFrame(frame);

  // Start with quality-based count
  if(window.__rth_controls.quality === 'low') particleSys.setCount(40); else particleSys.setCount(90);
})();

/* =====================================================
   LIGHTNING scheduling (overlay)
   ===================================================== */
(function(){
  const flashEl = document.querySelector('.rth-lightning');
  if(!flashEl) return;
  const LMIN = 7000, LMAX = 14000, MAXINT = 0.7;
  function doFlash(){
    const lx = 15 + Math.random()*70;
    const ly = 20 + Math.random()*55;
    const intensity = (0.25 + Math.random()*MAXINT).toFixed(3);
    flashEl.style.background = `radial-gradient(circle at ${lx}% ${ly}%, rgba(255,255,255,${intensity}) 0%, rgba(255,255,255,0) 18%)`;
    setTimeout(()=> {
      flashEl.style.background = `radial-gradient(circle at ${lx}% ${ly}%, rgba(255,255,255,${(intensity*0.5).toFixed(3)}) 0%, rgba(255,255,255,0) 26%)`;
      setTimeout(()=> { flashEl.style.background = 'transparent'; }, 140 + Math.random()*240);
    }, 90 + Math.random()*140);
  }
  (function loop(){ setTimeout(()=>{ doFlash(); loop(); }, LMIN + Math.random()*(LMAX-LMIN)); })();
})();

/* =====================================================
   UI: toggle, long-press for Hellfire, glitch trigger
   - ensures layout unchanged
   ===================================================== */
(function(){
  const sw = document.getElementById('switch');
  const body = document.body;
  const key = 'rth_blood_state_v3';
  const logo = document.querySelector('.logo');

  function read(){ try{ return localStorage.getItem(key) === '1'; }catch(e){ return false; } }
  function write(v){ try{ localStorage.setItem(key, v ? '1' : '0'); }catch(e){} }

  function triggerLogoGlitch(){
    if(!logo) return;
    logo.classList.add('glitch');
    setTimeout(()=> logo.classList.remove('glitch'), 480);
  }

  function apply(on){
    if(on){
      body.classList.add('blood');
      sw.dataset.state = 'on';
      window.__rth_sound && window.__rth_sound.playOn && window.__rth_sound.playOn();
      // subtle extra drip spawn immediately
      try{ if(window.__rth_particles) window.__rth_particles.setCount(120); }catch(e){}
    } else {
      body.classList.remove('blood');
      sw.dataset.state = 'off';
      window.__rth_sound && window.__rth_sound.playOff && window.__rth_sound.playOff();
      try{ if(window.__rth_particles) window.__rth_particles.setCount(window.__rth_controls.quality==='low'?40:90); }catch(e){}
    }
    write(on);
  }

  // long press for hellfire (800ms)
  let pressTimer = null;
  const HOLD = 800;
  sw.addEventListener('pointerdown', function(e){
    pressTimer = setTimeout(()=> {
      body.classList.toggle('hellfire');
      triggerLogoGlitch();
    }, HOLD);
  });
  sw.addEventListener('pointerup', function(e){
    if(pressTimer){
      clearTimeout(pressTimer);
      pressTimer = null;
      // treat as normal click
      const isOn = body.classList.contains('blood');
      apply(!isOn);
      triggerLogoGlitch();
    } else {
      // long press already fired
    }
  });
  sw.addEventListener('pointerleave', function(){ if(pressTimer){ clearTimeout(pressTimer); pressTimer=null; } });

  // keyboard support
  sw.addEventListener('keydown', function(e){
    if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); const isOn = body.classList.contains('blood'); apply(!isOn); triggerLogoGlitch(); }
    if(e.key === 'H' || e.key === 'h'){ body.classList.toggle('hellfire'); triggerLogoGlitch(); }
  });

  // CTA click sets blood ON (keeps existing behavior)
  function ctaHandler(){ apply(true); triggerLogoGlitch(); }
  function bindCTAs(){ document.querySelectorAll('.cta').forEach(a=>{ a.removeEventListener('click', ctaHandler); a.addEventListener('click', ctaHandler, {passive:true}); }); }
  bindCTAs();
  const mo = new MutationObserver(()=> bindCTAs());
  mo.observe(document.body, {childList:true, subtree:true});

  // init on load
  window.addEventListener('load', ()=> {
    document.body.classList.add('bg-ready');
    const saved = read();
    apply(saved);
    // hide loader
    const loader = document.getElementById('rth-loader');
    setTimeout(()=> { if(loader) loader.classList.add('hidden'); }, 420);
    // ensure particle count ok
    if(window.__rth_particles){
      if(window.__rth_controls.quality === 'low') window.__rth_particles.setCount(40); else window.__rth_particles.setCount(90);
    }
  });

  // safety fallback
  setTimeout(()=> {
    const loader = document.getElementById('rth-loader');
    if(loader && document.body.contains(loader)) loader.classList.add('hidden');
  }, 6000);

  // expose small API
  window.__rth_controls.toggleBlood = function(v){ apply(v===undefined ? !document.body.classList.contains('blood') : !!v); };
  window.__rth_controls.toggleHellfire = function(v){ if(v===undefined) document.body.classList.toggle('hellfire'); else if(v) document.body.classList.add('hellfire'); else document.body.classList.remove('hellfire'); };
  window.__rth_controls.triggerLogo = triggerLogoGlitch;
})();

/* =====================================================
   Particle quality auto-adjust on low-memory devices
   (best-effort - not intrusive)
   ===================================================== */
(function(){
  try{
    const mem = navigator.deviceMemory || 4;
    if(mem <= 1.5){ window.__rth_controls.setQuality('low'); }
  }catch(e){}
})();

</script>
</body>
</html>
